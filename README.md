# Constellation-Constrained-Waterfilling
Approximation of the Mercury/Waterfilling based on the sphere packing method

fig_3.m gives the constellation capacity of M-PAM in comparison to the Gaussian Channel Capacity.

fig_6_1.m gives the Gaussian Channel Capacity, the Constellation Capacity and its Sphere Packing Approximation.

fig_9.m, fig_9_bisection.m, and fig_9_numerical.m shows the power allocation versus constellation order (M-PAM) using three different methods. The CVX, the numerical method and the bisection method are used respectively.

fig_8.m, fig_8_bisection.m, and fig_8_numerical.m shows the sub-channel capacity versus the constellation order (M-PAM). The constellation constrained waterfilling is compared with the classic waterfilling in terms of capacity, using the CVX, the numerical method and the bisection method respectively.

fig_10.m gives an analytical approximation of the constellation capacity of 2-PAM. The analytical approximation and the constellation capacity are derived using the Monte Carlo method.

fig_11.m shows the analytical approximation, the sphere packing approximation and the constellation capacity using the Monte Carlo method with 2-PAM and 4-PAM inputs.
